## UTRA+ROS2で実行する
[UTRA-ROS2](https://github.com/UmbraTek/ut_arm_ros2)

今回はROS2 on Dockerの形で作る
[Docker-ROS_Humble](https://qiita.com/porizou1/items/76980fbd0d1675eecf7f)
→今後の学生が初期環境を構築しやすくするため


### Dockerfile
[Dockerfileからコンテナ作成](https://qiita.com/shinya_sun_sun/items/a2e762e1520509adc16d)
usb関連の設定はdockerfile内には書けない
ホストのubuntu側でusbマッピング
その後
```
# ベースイメージの設定

FROM nvidia/opengl:base-ubuntu22.04

  

# 環境変数の設定

ENV DEBIAN_FRONTEND=noninteractive
# 対話モード無効

ENV __NV_PRIME_RENDER_OFFLOAD=1

ENV __GLX_VENDOR_LIBRARY_NAME=nvidia
# GPU利用
  

# 必要なパッケージのインストール

RUN apt-get update && apt-get install -y \

    curl \

    gnupg \

    lsb-release

  

# ROSのリポジトリをsource listに追加

ENV UBUNTU_CODENAME=jammy

RUN curl -s https://raw.githubusercontent.com/ros/rosdistro/master/ros.asc | apt-key add - \

    && echo "deb http://packages.ros.org/ros2/ubuntu $(lsb_release -cs) main" > /etc/apt/sources.list.d/ros2-latest.list

  

# ROS2のインストール

RUN apt-get update && apt-get install -y \

    ros-humble-desktop

  

# colconのインストール

RUN apt-get install -y python3-colcon-common-extensions

# rqtのプラグインをインストール

RUN apt-get install -y ros-humble-rqt-*

  

# ワークスペースの作成

RUN mkdir -p ~/worksp/utra_ws/src

WORKDIR /root/worksp/utra_ws/src

RUN /bin/bash -c '. /opt/ros/humble/setup.bash; colcon build'

  

# エントリーポイントを設定

COPY ./ros_entrypoint.sh /

RUN chmod +x /ros_entrypoint.sh

ENTRYPOINT ["/ros_entrypoint.sh"]

  

# コマンドを設定

CMD ["bash"]
```
### Nvidia-Dockerについて
これを入れるとコンテナの中からGPU情報を見れるようになる

### Nvidia-driverインストール
事前にSecure bootをEnableにしておく
![[Pasted image 20250418182816.png]]
支持に従う
右矢印を押していけばOKを押せる

