# 学習用データ
# soft
1. マシュマロ
2. スポンジ
3. みかん
4. まんじゅう
## hard
1. Fake-fruit
2. ペットボトルの蓋
3. 人形
4. ドライバー

---


## 今のところできてるやつ
- グリッパー完成
- データ取得用testスクリプト
	- CONTACTから
### 1) GelSightストリームの取得ができている

- 指定URL（`http://<ip>:<port>/cam_feed/<cam_id>`）から OpenCV `VideoCapture` で取得
    
- `FrameReader` スレッドで最新フレームを継続取得（低遅延化）
    
- バッファサイズを `CAP_PROP_BUFFERSIZE=1` に設定済み
    

### 2) GelSightのCONTACT / NON_CONTACT 判定ができている

- `ContactDetector` により、
    
    - 最初の `n0_frames` から基準画像 `I0` を構築
        
    - `E = mean(abs(diff-0.5))` の差分エネルギーで閾値判定
        
    - `INITIALIZING / CONTACT / NON_CONTACT` を出力
        
- 閾値 `contact_threshold`、基準構築枚数 `contact_n0_frames` をパラメータ化済み
    

### 3) ROS2トピックとして触覚画像と状態を配信できている

- `/tactile/raw_rgb`（BGR8）
    
- `/tactile/diff_rgb`（32FC3, 0〜1想定）
    
- `/tactile/diff_rgb_vis`（BGR8, オプション）
    
- `/tactile/contact_state`（String）
    
- `/tactile/contact_energy`（Int32, energy×10000）
    

### 4) 参照フレームのリセットができている

- `/tactile/reset_ref`（std_msgs/Empty）を購読し、diff用参照フレームをリセット可能
    

### 5) データ収集（AVI保存）の開始/停止がサービスでできている good

- `/tactile/start_collection`（SetBool）
    
    - True で収集開始：`gelsight_raw.avi` と `gelsight_diff.avi` を作成し、別スレッドで保存
        
    - False で収集停止：writerをcloseし、ログを保存
        
- 保存は `AsyncAviSaver` で非同期（キュー）化済みで、メインループの遅延を抑える設計
    

### 6) 接触状態とモータ状態のログが取れている good

- `contact_log.csv` に以下を記録
    
    - 経過時間（elapsed）
        
    - state（INITIALIZING/CONTACT/NON_CONTACT）
        
    - energy
        
    - gripper_step（`/gripper/current_step` を購読）
        

### 7) 接触検出器のリセットがサービスでできている good

- `/tactile/reset_detector`（Trigger）で `I0` 再構築を開始できる
    
### 8) 光外乱対策は完了している（あなたの申告ベース）
---
## グリッパー制御用コード

改良版
`ros2 run gripper_control gripper_control --ros-args -p stop_on_contact:=true`

ゼロ合わせ（任意）：

`ros2 service call /gripper/set_zero std_srvs/srv/Empty {}`

締め続け開始（CONTACTで止まる）：

`ros2 service call /gripper/close_until_contact std_srvs/srv/Trigger`

手動停止：

`ros2 service call /gripper/stop_close std_srvs/srv/Trigger`



---

## 次

- 押し込み処理
- データ収集コード
- データ収集(2h)
- 学習
- 